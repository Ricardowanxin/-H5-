<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport"
		content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<title>福米志愿者招募令</title>
	<link rel="stylesheet" href="css/animate.css" type="text/css" />
	<link rel="stylesheet" href="css/animate.min.css" type="text/css" />
	<link href="js/layer/need/layer.css" rel="stylesheet" />
	<link rel="stylesheet" href="css/swiper.min.css" type="text/css" />
	<link rel="stylesheet" href="css/generals.css" type="text/css" />
	<link href="http://cdn.clouddeep.cn/amazeui/1.0.1/css/amazeui.css" rel="stylesheet" type="text/css" />

</head>

<body>
	<div class="container">
		<div class="music-icon music-open abs zoomS">
			<img src="./img/music-icon.png">
		</div>
		<div class="swiper-container">
			<div class="logo1 abs zoomS">
				<img src="./img/logo.png">
			</div>
			<div class="bg"></div>
			<div class="swiper-wrapper">
				<div class="swiper-slide " id="swiper-slide0">
					<div class="page">
						<div class="content">
							<div class="ani title abs h-center" swiper-animate-effect=" bounceInLeft"
								swiper-animate-duration="2.5s" swiper-animate-delay="0.3s">
								<div class="p-4 abs h-center ani" swiper-animate-effect="  bounceInRight"
									swiper-animate-duration="2.8s" swiper-animate-delay="0.3s"></div>
								<div class="p-2 abs h-center ani" swiper-animate-effect="fadeInUp"
									swiper-animate-duration="1.5s" swiper-animate-delay="0.3s"></div>
								<div class="btn abs h-center"></div>
								<div class="btn2 abs h-center" href="#" id="btn3"></div>
							</div>
						</div>
					</div>
				</div>
				<div class="swiper-slide page-infoi" id="swiper-slide1">
					<div class="page">
						<div class="content">
							<div class="ani slide-1 abs h-center" swiper-animate-effect="bounceInRight"
								swiper-animate-duration="2.5s"></div>
							<div class="slide-2 abs h-center ani" swiper-animate-effect="fadeInUp"
								swiper-animate-duration="2s" swiper-animate-delay="0.3s"></div>
							<div class="p-1 abs h-center ani" swiper-animate-effect="fadeInUp"
								swiper-animate-duration="2s" swiper-animate-delay="0.3s"></div>
							<div class="arrow-1 abs h-center ani" swiper-animate-effect="fadeInUp"
								swiper-animate-duration="2s" swiper-animate-delay="0.3s"></div>
						</div>
					</div>
				</div>
				<div class="swiper-slide" id="swiper-slide2">
					<div class="page">
						<div class="content">
							<div class="slide-5 abs h-center ani" swiper-animate-effect="bounceInRight"
								swiper-animate-duration="1s" swiper-animate-delay="0.3s"></div>
							<div class="slide-6 abs h-center  ani" swiper-animate-effect="bounceInLeft"
								swiper-animate-duration="2.8s" swiper-animate-delay="0.6s"></div>
							<div class="slide-7 abs h-center  ani" swiper-animate-effect="bounceInLeft"
								swiper-animate-duration="2.8s" swiper-animate-delay="0.9s"></div>
							<div class="slide-8 abs h-center ani" swiper-animate-effect="bounceInLeft"
								swiper-animate-duration="1.8s" swiper-animate-delay="1s"></div>
							<div class="slide-9 abs h-center ani" swiper-animate-effect="bounceInLeft"
								swiper-animate-duration="2.9s" swiper-animate-delay="1.5s"></div>
							<div class="slide-10 abs h-center ani" swiper-animate-effect="bounceInLeft"
								swiper-animate-duration="2.8s" swiper-animate-delay="1.8s"></div>
							<div class="slide-11 abs h-center ani" swiper-animate-effect="bounceInLeft"
								swiper-animate-duration="2.8s" swiper-animate-delay="2.1s"></div>
							<div class="slide-12 abs h-center ani" swiper-animate-effect="bounceInLeft"
								swiper-animate-duration="2.8s" swiper-animate-delay="2.4s"></div>
							<div class="slide-13 abs h-center ani" swiper-animate-effect="bounceInLeft"
								swiper-animate-duration="2.8s" swiper-animate-delay="2.7s"></div>
							<div class="arrow-2 abs h-center ani" swiper-animate-effect="bounceInLeft"
								swiper-animate-duration="2.8s" swiper-animate-delay="3s">
							</div>
						</div>
					</div>
				</div>
				<div class="swiper-slide" id="swiper-slide3">
					<div class="page ">
						<div class="content">
							<div class="bg-form abs h-center  ani" swiper-animate-effect="zoomInUp"
								swiper-animate-duration="1" swiper-animate-delay="0.1s">
								<div class="host-title abs form-title"><span class="selected"></span>&nbsp;车主</div>
								<div class="unhost-title abs form-title"><span></span>&nbsp;非车主</div>
								<div class="host abs h-center">
									<div class="form-content2 abs h-center" id="c">
										<!-- placeholder属性规定可描述输入字段预期值的简短的提示信息  ,type=tel,电话h5新属性-->
										<input class="user-name2 abs" type="text" placeholder="姓名" id="abc">
										<input class="user-tel2 abs" type="text" placeholder="电话" id="def">
										<input class="car-no abs" type="text" placeholder="车架号" id="ghi">
									</div>
								</div>
								<div class="unhost abs h-center">
									<div class="form-content abs h-center">
										<input class="user-name abs" type="text" placeholder="姓名" id="qwe">
										<input class="user-tel abs" type="text" placeholder="电话" id="asd">
										<select class="dream-car abs">
											<option>意向车型</option>
											<option>经典福克斯</option>
											<option>福特金牛座</option>
											<option>新一代福克斯</option>
											<option>福特新蒙迪欧</option>
											<option>福特新蒙迪欧插电混动版</option>
											<option>全新福特翼搏</option>
											<option>新福特翼虎</option>
											<option>福特锐界</option>
											<option>全新福特领界</option>
										</select>
										<select class="dealer-prov prov abs"></select>
										<select class="dealer-city city abs">
											<option>城市</option>
										</select>
										<select class="dealer-name abs ">
											<option>经销商</option>
										</select>
									</div>
								</div>
								<div class="btn-submit abs h-center"></div>
								<div class="tips abs h-center" id="tip">报名时间：即日起-12月20日</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<audio id="bgm" preload="auto" loop="loop" autoplay>
		<source src="audios/背景.mp3" type="audio/mpeg" />
	</audio>
	<script src="js/jquery-1.8.2.min.js"></script>
	<script src="js/swiper.min.js"></script>
	<script src="js/layer/layer.js"></script>
	<script src="js/index.js"></script>
	<script type="text/javascript" src="js/wx.js"></script>
	<script type="text/javascript" src="js/swiper.animate.min.js"></script>

	<!-- 经销商数据 -->
	<script src="js/data.js"></script>
	<script src="js/test.js"></script>
	<script>
		var _hmt = _hmt || [];
		var hm = document.createElement("script");
		hm.src = "https://hm.baidu.com/hm.js?50dc762b12de32261cc7d7568287e005";
		var s = document.getElementsByTagName("script")[0];
		s.parentNode.insertBefore(hm, s);

		//先要渲染元素，在绑定事件，要先写$(function()
		$(function () {
			/* 对象初始化是一个描述对象初始化过程的表达式。对象初始化是由一组描述对象的属性组成。
			属性的值可以是原始类型，也可以是其他对 
			这里postdata为创建一个数组对象			
			 创建object类型 var o = new object();为其添加属性和方法，就可以创建自定义对象
			*/
			var postData = {};
			//var postData2 = {};//验证后数据
			//removeclass 从所有匹配的元素中删除全部或者指定的类
			// selected 下·预先选择一个选项。
			//Query 选择器允许您对 HTML 元素组或单个元素进行操作。
			//jQuery 选择器基于元素的 id、类、类型、属性、属性值等"查找"（或选择）HTML 元素。 它基于已经存在的 CSS 选择器
			//jQuery 中所有选择器都以美元符号开头：$()
			//.form-title'类选择器
			$('.form-title').on('click', function () {
				$('.form-title span').removeClass('selected');
				$(this).find('span').addClass('selected');
				if ($('.host-title span').hasClass('selected')) {

					$('.unhost').css('display', 'none'); //css方法设置或返回匹配元素的样式属性
					$('.host').css('display', 'block');

				} else {
					$('.host').css('display', 'none');
					$('.unhost').css('display', 'block');
				}
			});

			$('.btn-submit').on('click', function () {
				//车主数据
				// hasClass() 方法检查匹配的所有元素里是否含有指定类名
				//val（）返回第一个匹配元素的 value 属性的值
				if ($('.host-title span').hasClass('selected')) {
					postData = {
						is_car: 1,
						username: $('.host .user-name2').val(), //val()获得class属性为host的username的值
						telephone: $('.host .user-tel2').val(),
						car: $('.host .car-no').val(),
						province: 'province',
						city: 'city',
						dealer: 'dealer',
						address: 'address'
					}

				} else if ($('.unhost-title span').hasClass('selected')) (
					//非车主数据
					postData = {
						is_car: 0,
						username: $('.unhost .user-name').val(),
						telephone: $('.unhost .user-tel').val(),
						car: $('.unhost .dream-car').val(),
						province: $('.unhost .prov').val(),
						city: $('.unhost .city').val(),
						dealer: $('.unhost .dealer-name').val(),
						address: 'address'
					}
				)
                //当程序走到这里就会在输出信息
                 console.log("调试信息")
				/* 验证数据有效性 */
				if (!postData.username) {
					msg('请填写姓名')
					return false;
				}
				if (!postData.telephone) {
					msg("请填写电话")
					return false;
				}
				if (!/^1\d{10}$/.test(postData.telephone)) {
					msg("手机号码格式有误")
					return false;

				}
				if (postData.is_car == "1") {
					if (!postData.car) {
						msg("请填写车架号")
						return false;
					}
					if (postData.car.length !== 17) {
						msg("请填写正确的17位车架号")
						return false;
					}
				}
				else {
					if (postData.car == '意向车型') {
						msg("请选择意向车型")
						return false;
					}
				}
				if (postData.province == '省份') {
					msg("请选择省份")
					return false;
				}
				if (postData.city == '城市') {
					msg("请选择城市")
					return false;
				}
				if (postData.dealer == '经销商') {
					msg("请选择经销商");
					return false;
				}
				if (!postData.address) {
					msg("请输入地址");
					return false;
				} else {
					//给数据加上字符串，应该在这个else里面加
					// $(selector).post(URL,data,function(data,status,xhr),dataType)
					// 代码中的 res =>可以理解为function(res)，其中res即为返回的数据结果对象 //转换成json字符串
					/* 对验证后的数据做判断 ,添加字符串*/
					//车主数据
					/*if ($('.host-title span').hasClass('selected')) {
						postData2 = {
							is_car: 1,
							username: '长安福特粉丝盛典' + $('.host .user-name2').val(), //对验证后的数据添加字符串
							telephone: $('.host .user-tel2').val(),
							car: $('.host .car-no').val(),
							province: 'province',
							city: 'city',
							dealer: 'dealer',
							address: 'address'
						}
					} else if ($('.unhost-title span').hasClass('selected')) (
						//非车主数据
						postData2 = {
							is_car: 0,
							username: '长安福特粉丝盛典' + $('.unhost .user-name').val(),
							telephone: $('.unhost .user-tel').val(),
							car: $('.unhost .dream-car').val(),
							province: $('.unhost .prov').val(),
							city: $('.unhost .city').val(),
							dealer: $('.unhost .dealer-name').val(),
							address: 'address'
						}
					)*///
					/* :input $(":input") 所有 <input> 元素
					:text $(":text")所有 type="text" 的 <input>元素 */
					//验证后清空输入框
					function clearinput() {
						//var a = $("input:text");//选择属性为text的所有input元素
						var a = $(":text");//简写
						{
							//调试信息
							console.log("dsad")
							//$(selector).each(function(index,element))，为每个匹配元素规定运行的函数
							a.each(
								function (i) {
									$(this).val("")
								}
							)
						}
					}
					var data = JSON.stringify(postData);//转换成json字符串，这一步是对数据做处理
					//后端规定参数名是note 内容是data ，即data：note：data
					$.ajax({
						type: 'post',
						url: 'http://mooncake-api.fordh5.e2cysd.com/addFansInfo.ashx',
						cache: false, //上传文件不需缓存				
						data: postData, //这里直接传对象，不转换传json字符串
						//data: { note: data },//这样子传的是json字符串
						dataType: 'json',
						success: function (data) {
							if (data.err_code == 0) {
								msg('提交成功~');
								clearinput();
								//$('.form-content2').css('display', 'none')隐藏元素
								/* $("#abc").val("");
								 $("#def").val("");//设置#def元素的值为空
								 $("#ghi").val("");
								 $("#qwe").val("");
								 $("#asd").val("");*/
							} else {
								msg('提交失败:' + data.msg);
							}
						}
					});
				}
			});


			//定义一个数组
			var provList = [];
			var prov = '<option>省份</option>';
			//　　$.each(array,function(Key,Value){ })
			//push() 方法可向数组的末尾添加一个或多个元素，并返回新的长
			/*$.each( object, callback )是jquery的一个遍历数组的方法 
			两个参数，第一个参数index表示遍历的数组的下标，第二个参数value表示下标对应的值
			function (i, v),所以i就表示index v就表示value
			 */
			$.each(dealerList, function (i, v) {
				provList.push(v.prov)//proList=Array（1）
			})
			/* Array.from()方法就是将一个类数组对象或者可遍历对象转换成一个真正的数组 */
			$.each((Array.from(new Set(provList))), function (i, v) {
				//例如 i += 1等同于i = i + 1 
				prov += '<option>' + v + '</option>'//等价于prov=prov+'<option>' + v + '</option>'
			})
			/* html方法设置被选元素prov的内容为prov*/
			$('.prov').html(prov);

			var provVal = '';
			//向prov元素添加 change 事件处理程序：
			//$(selector).on(event,childSelector,data,function).event是事件
			$('.prov').on('change', function () {
				provVal = $(this).val();
				var cityList = [];
				// each遍历元素vue
				$.each(dealerList, function (i, v) {
					if (v.prov == provVal) {
						//push()向数组的末尾添加一个或更多元素，并返回新的长度。
						cityList.push(v.city);
					}
				});
				var city = '<option>城市</option>';
				$.each((Array.from(new Set(cityList))), function (i, v) {
					city += '<option>' + v + '</option>'
				})
				//设置元素内容当使用该方法设置一个值时，它会覆盖所有匹配元素的内容。
				//语法$(selector).html(content)
				$('.city').html(city);
				$('.dealer-name').html('');
			})

			$('.city').on('change', function () {
				var cityVal = $(this).val();
				var dealername = '<option>经销商</option>';
				$.each(dealerList, function (i, v) {
					if (v.prov == provVal && v.city == cityVal) {
						dealername += '<option>' + v.dealername + '</option>'
					}
				});
				$('.dealer-name').html(dealername);
			})
		})
	</script>
</body>

</html>